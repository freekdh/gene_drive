(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     44413,       1340]
NotebookOptionsPosition[     42670,       1277]
NotebookOutlinePosition[     43016,       1292]
CellTagsIndexPosition[     42973,       1289]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Compare Sally to Freek", "Chapter",
 CellChangeTimes->{{3.765900527277203*^9, 3.7659005438828955`*^9}, {
  3.765912834117244*^9, 3.7659128366612206`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Loci", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<Aw\>\"", ",", "\"\<Ad\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Bw\>\"", ",", "\"\<Bd\>\""}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Gametes", " ", "=", 
   RowBox[{"Tuples", "[", "Loci", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Genotypes", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{"Gametes", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Wpayload", "=", 
   RowBox[{"MakeFitnessMatrix", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<Ad\>\"", ",", "\"\<Bd\>\""}], "}"}], ",", "pars", ",", 
     "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Wtoxin", "=", 
   RowBox[{"Make2LocusUnderDominanceFitnessMatrix", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<Bd\>\"", ",", "\"\<Ad\>\""}], "}"}], ",", "pars", ",", 
     "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"W", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "\[Epsilon]", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"h", " ", "s"}]}], ")"}], " ", "\[Epsilon]"}], ",", 
     RowBox[{"1", "-", 
      RowBox[{"h", " ", "s"}]}], ",", "\[Epsilon]", ",", "\[Epsilon]", ",", 
     RowBox[{"1", "-", 
      RowBox[{"h", " ", "s"}]}], ",", 
     RowBox[{"1", "-", 
      RowBox[{"h", " ", "s"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"h", " ", "s"}]}], ")"}], " ", "\[Epsilon]"}], ",", 
     RowBox[{"1", "-", 
      RowBox[{"h", " ", "s"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "s"}], ")"}], " ", "\[Epsilon]"}], ",", 
     RowBox[{"1", "-", "s"}], ",", 
     RowBox[{"1", "-", 
      RowBox[{"h", " ", "s"}]}], ",", 
     RowBox[{"1", "-", 
      RowBox[{"h", " ", "s"}]}], ",", 
     RowBox[{"1", "-", "s"}], ",", 
     RowBox[{"1", "-", "s"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ArrayReshape", "[", 
    RowBox[{"W", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Length", "[", "Gametes", "]"}], ",", 
       RowBox[{"Length", "[", "Gametes", "]"}]}], "}"}]}], "]"}], "//", 
   "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"DriveMatrix", " ", "=", " ", 
  RowBox[{"MakeDriveMatrix", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Ad\>\"", ",", "\"\<Aw\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Bd\>\"", ",", "\"\<Bw\>\""}], "}"}]}], "}"}], ",", "pars",
     ",", "d"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pars", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<Loci\>\"", "\[Rule]", "Loci"}], ",", 
     RowBox[{"\"\<Gametes\>\"", "\[Rule]", "Gametes"}], ",", 
     RowBox[{"\"\<Genotypes\>\"", "\[Rule]", "Genotypes"}], ",", 
     RowBox[{"\"\<Fitness\>\"", "\[Rule]", "W"}], ",", 
     RowBox[{"\"\<DriveMatrix\>\"", "->", "DriveMatrix"}]}], "|>"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.765900576549166*^9, 3.7659006019555025`*^9}, 
   3.7659039749085536`*^9, {3.765907066684516*^9, 3.765907069575677*^9}, {
   3.765911318415407*^9, 3.7659113185560217`*^9}, {3.7659113588542633`*^9, 
   3.7659113656910295`*^9}, {3.7659116059534674`*^9, 3.765911647647503*^9}, {
   3.765911827491014*^9, 3.765911828515544*^9}, {3.7659122806017513`*^9, 
   3.7659123628459716`*^9}, {3.7659135621970844`*^9, 3.7659136359543095`*^9}}],

Cell[BoxData[
 TagBox[
  TemplateBox[{RowBox[{
      StyleBox[
       TagBox["SparseArray", "SummaryHead"], "NonInterpretableSummary"], 
      StyleBox["[", "NonInterpretableSummary"], 
      DynamicModuleBox[{Typeset`open$$ = False}, 
       PanelBox[
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquarePlusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = True), Appearance -> None,
                 Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}]], 
              GraphicsBox[
               RasterBox[CompressedData["
1:eJxTTMoPSmVmYGAQgGIQ26p8d9wspXP2c4wXbTH/ccX+xSLFx4GrXtmTKs4A
Bg+gNAJQyxxSzaeWemqJ7+w2cN255YX9Dffl62qmvbU/GZH7L/7re5LDmdbi
pIbbYHPPYHP/UAk3WufHUfHhkR+HijuHa7kx2NxJqnuGSj041MUHWzoZruKj
4Tza3hhO4qPhTJ/0PFoPDq14HBUfDefBID4azqPhPJzER+vBgRUHAG2XQlk=

                "], {{0, 0}, {16, 16}}, {0, 1}], AspectRatio -> 1, Axes -> 
               False, Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
               Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}], 
               Method -> {
                "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                 Automatic, "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["36", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"16", ",", "16"}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquareMinusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}]], 
              GraphicsBox[
               RasterBox[CompressedData["
1:eJxTTMoPSmVmYGAQgGIQ26p8d9wspXP2c4wXbTH/ccX+xSLFx4GrXtmTKs4A
Bg+gNAJQyxxSzaeWemqJ7+w2cN255YX9Dffl62qmvbU/GZH7L/7re5LDmdbi
pIbbYHPPYHP/UAk3WufHUfHhkR+HijuHa7kx2NxJqnuGSj041MUHWzoZruKj
4Tza3hhO4qPhTJ/0PFoPDq14HBUfDefBID4azqPhPJzER+vBgRUHAG2XQlk=

                "], {{0, 0}, {16, 16}}, {0, 1}], AspectRatio -> 1, Axes -> 
               False, Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
               Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}], 
               Method -> {
                "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                 Automatic, "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["36", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"16", ",", "16"}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0.140625`", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"\"", "SummaryItem"]}]}, {
                 TagBox[
                  TagBox[
                   GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"1", "-", "d"}], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"3", ",", "3"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"1", "-", "d"}], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "-", "d"}], ")"}], "2"], ContentPadding -> 
                    False, FrameMargins -> 0, StripOnInput -> True, 
                    BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                   "Column"], "SummaryItem"]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic], BaselinePosition -> 
        Baseline], DynamicModuleValues :> {}], 
      StyleBox["]", "NonInterpretableSummary"]}]},
   "CopyTag",
   DisplayFunction->(#& ),
   InterpretationFunction->("SparseArray[<36>, {16, 16}]"& )],
  False,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{{3.765912318537687*^9, 3.7659123696386924`*^9}, 
   3.7659128388054113`*^9, {3.765913770057893*^9, 3.765913771397971*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Freek:", "Subsection",
 CellChangeTimes->{{3.76591681595236*^9, 3.7659168166088552`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Drive", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"F", "[", "i", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "Gametes", "]"}]}], "}"}]}], "]"}], ",", 
    "pars"}], "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.7659160455979204`*^9, 3.765916092785024*^9}, {
  3.765916349828869*^9, 3.765916350691819*^9}, {3.7659163921800275`*^9, 
  3.765916392501212*^9}, {3.765916671757888*^9, 3.7659166724755764`*^9}, {
  3.7659177028364015`*^9, 3.7659177036697245`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"F", "[", "1", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"F", "[", "1", "]"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"F", "[", "2", "]"}], "+", 
         RowBox[{"F", "[", "3", "]"}], "+", 
         RowBox[{"F", "[", "4", "]"}], "-", 
         RowBox[{"d", " ", 
          RowBox[{"F", "[", "4", "]"}]}]}], ")"}]}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", "1", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "d"}], ")"}], " ", 
        RowBox[{"F", "[", "2", "]"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "d", " ", 
        RowBox[{"F", "[", "4", "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"F", "[", "2", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"F", "[", "2", "]"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"F", "[", "3", "]"}], "+", 
          RowBox[{"F", "[", "4", "]"}]}], ")"}]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", "3", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"F", "[", "2", "]"}], "-", 
       RowBox[{"d", " ", 
        RowBox[{"F", "[", "2", "]"}]}], "+", 
       RowBox[{"F", "[", "3", "]"}], "+", 
       RowBox[{"F", "[", "4", "]"}], "-", 
       RowBox[{"d", " ", 
        RowBox[{"F", "[", "4", "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"F", "[", "1", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "d"}], ")"}], " ", 
        RowBox[{"F", "[", "3", "]"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "d", " ", 
        RowBox[{"F", "[", "4", "]"}]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"F", "[", "1", "]"}], " ", 
     RowBox[{"F", "[", "4", "]"}]}], "+", 
    RowBox[{
     RowBox[{"F", "[", "4", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"F", "[", "1", "]"}], "+", 
       RowBox[{"F", "[", "2", "]"}], "+", 
       RowBox[{"F", "[", "3", "]"}], "+", 
       RowBox[{"F", "[", "4", "]"}]}], ")"}]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"F", "[", "3", "]"}], " ", 
        RowBox[{"F", "[", "4", "]"}]}], "+", 
       RowBox[{
        RowBox[{"F", "[", "2", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"F", "[", "3", "]"}]}], "+", 
          RowBox[{"F", "[", "4", "]"}]}], ")"}]}]}], ")"}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.765916056420162*^9, 3.7659160931166677`*^9}, 
   3.7659163509152637`*^9, {3.7659163884506474`*^9, 3.7659163928266087`*^9}, 
   3.765916672730894*^9, 3.7659177039739113`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"Checked", " ", "the", " ", "drive", " ", "recursions"}], ",", 
    " ", 
    RowBox[{
    "they", " ", "are", " ", "the", " ", "same", " ", "as", " ", "Sally", 
     "*"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.7659165624465866`*^9, 3.7659165709905806`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Recombination", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"F", "[", "i", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "Gametes", "]"}]}], "}"}]}], "]"}], ",", 
    "pars"}], "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.7659166331936846`*^9, 3.765916663547258*^9}, {
  3.7659166981947126`*^9, 3.7659166989976044`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"F", "[", "1", "]"}], "2"], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"F", "[", "2", "]"}], " ", 
     RowBox[{"F", "[", "3", "]"}]}], "+", 
    RowBox[{
     RowBox[{"F", "[", "1", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"F", "[", "2", "]"}], "+", 
       RowBox[{"F", "[", "3", "]"}], "+", 
       FractionBox[
        RowBox[{"F", "[", "4", "]"}], "2"]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", "1", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"F", "[", "2", "]"}], "+", 
       FractionBox[
        RowBox[{"F", "[", "4", "]"}], "2"]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"F", "[", "2", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"F", "[", "2", "]"}]}], "+", 
       RowBox[{"F", "[", "3", "]"}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"F", "[", "4", "]"}]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", "1", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"F", "[", "3", "]"}], "+", 
       FractionBox[
        RowBox[{"F", "[", "4", "]"}], "2"]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"F", "[", "3", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"F", "[", "2", "]"}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"F", "[", "3", "]"}], "+", 
          RowBox[{"F", "[", "4", "]"}]}], ")"}]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", "2", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"F", "[", "3", "]"}], "2"], "+", 
       RowBox[{"F", "[", "4", "]"}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"F", "[", "4", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"F", "[", "1", "]"}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"F", "[", "3", "]"}], "+", 
          RowBox[{"F", "[", "4", "]"}]}], ")"}]}]}], ")"}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.7659166569421988`*^9, 3.765916663747672*^9}, 
   3.765916699314772*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Checked", " ", "the", " ", "recombination"}], ",", " ", 
   RowBox[{
   "they", " ", "are", " ", "the", " ", "same", " ", "as", " ", "Sally"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.765916728228847*^9, 3.7659167386652393`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sally:", "Subsection",
 CellChangeTimes->{{3.765916820067004*^9, 3.765916821999939*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"geno", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x", "[", "1", "]"}], ",", 
        RowBox[{"x", "[", "2", "]"}], ",", 
        RowBox[{"x", "[", "4", "]"}], ",", 
        RowBox[{"x", "[", "5", "]"}]}], "}"}], "}"}], "]"}], ".", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "[", "1", "]"}], ",", 
       RowBox[{"x", "[", "2", "]"}], ",", 
       RowBox[{"x", "[", "4", "]"}], ",", 
       RowBox[{"x", "[", "5", "]"}]}], "}"}], "}"}]}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"type15", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "d"}], ")"}], "2"], 
       FractionBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "r"}], ")"}], "2"]}], ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "d"}], ")"}], "2"], 
       FractionBox["r", "2"]}], ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "d"}], ")"}], "2"], 
       FractionBox["r", "2"]}], ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "d"}], ")"}], "2"], 
       FractionBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "r"}], ")"}], "2"]}]}], "}"}], "+", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], "d", 
       FractionBox["1", "2"]}], ",", "0", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], "d", 
       FractionBox["1", "2"]}]}], "}"}], "+", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{"d", 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       FractionBox["1", "2"]}], ",", 
      RowBox[{"d", 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       FractionBox["1", "2"]}]}], "}"}], "+", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", 
      SuperscriptBox["d", "2"]}], "}"}]}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"type24", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "d"}], ")"}], "2"], 
       FractionBox["r", "2"]}], ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "d"}], ")"}], "2"], 
       FractionBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "r"}], ")"}], "2"]}], ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "d"}], ")"}], "2"], 
       FractionBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "r"}], ")"}], "2"]}], ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "d"}], ")"}], "2"], 
       FractionBox["r", "2"]}]}], "}"}], "+", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], "d", 
       FractionBox["1", "2"]}], ",", "0", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], "d", 
       FractionBox["1", "2"]}]}], "}"}], "+", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{"d", 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       FractionBox["1", "2"]}], ",", 
      RowBox[{"d", 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}], 
       FractionBox["1", "2"]}]}], "}"}], "+", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", 
      SuperscriptBox["d", "2"]}], "}"}]}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"seg", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "d"}], ")"}], "2"], ",", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "d"}], ")"}], "2"], ",", "0", ",", "0"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "d"}], ")"}], "2"], ",", "0", ",", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "d"}], ")"}], "2"], ",", "0"}], "}"}], ",", 
       "type15"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "d"}], ")"}], "2"], ",", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "d"}], ")"}], "2"], ",", "0", ",", "0"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", "type24", 
       ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "d"}], ")"}], "2"], ",", "0", ",", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "d"}], ")"}], "2"]}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "d"}], ")"}], "2"], ",", "0", ",", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "d"}], ")"}], "2"], ",", "0"}], "}"}], ",", 
       "type24", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "d"}], ")"}], "2"], ",", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "d"}], ")"}], "2"]}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"type15", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "d"}], ")"}], "2"], ",", "0", ",", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "d"}], ")"}], "2"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "d"}], ")"}], "2"], ",", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "d"}], ")"}], "2"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{3.7659168307814217`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"newgen", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"geno", "*", "seg"}], ")"}], "//", "Factor"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"newgametes", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"newgen", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "4"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"newgametes", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/.", 
    RowBox[{"d", "\[Rule]", "0"}]}], "/.", 
   RowBox[{"r", "\[Rule]", 
    FractionBox["1", "2"]}]}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.765916881071623*^9, 3.7659169185537014`*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"x", "[", "1", "]"}], "2"], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"x", "[", "2", "]"}], " ", 
   RowBox[{"x", "[", "4", "]"}]}], "+", 
  RowBox[{
   RowBox[{"x", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"x", "[", "2", "]"}], "+", 
     RowBox[{"x", "[", "4", "]"}], "+", 
     FractionBox[
      RowBox[{"x", "[", "5", "]"}], "2"]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.7659168931193647`*^9, 3.7659169189651184`*^9}, 
   3.765917645209448*^9}]
}, Open  ]],

Cell["And for drive:", "Text",
 CellChangeTimes->{{3.765916927254116*^9, 3.765916928856634*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"newgametes", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "/.", 
   RowBox[{"r", "\[Rule]", "0"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.7659169343025317`*^9, 3.7659169465558877`*^9}, 
   3.765917639702361*^9, {3.765917677641772*^9, 3.7659176825860043`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"x", "[", "1", "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"x", "[", "1", "]"}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"x", "[", "2", "]"}], "+", 
       RowBox[{"x", "[", "4", "]"}], "+", 
       RowBox[{"x", "[", "5", "]"}], "-", 
       RowBox[{"d", " ", 
        RowBox[{"x", "[", "5", "]"}]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.7659169357549915`*^9, 3.765916946912399*^9}, {
   3.7659176401057825`*^9, 3.765917647393615*^9}, 3.765917684066518*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"newgametes", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "/.", 
   RowBox[{"r", "\[Rule]", 
    FractionBox["1", "2"]}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.7659179407452545`*^9, 3.7659179437422276`*^9}, {
  3.765918027285079*^9, 3.7659180287641544`*^9}, {3.765918153295184*^9, 
  3.765918154338312*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"x", "[", "1", "]"}], "2"], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", 
   RowBox[{"x", "[", "2", "]"}], " ", 
   RowBox[{"x", "[", "4", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
   RowBox[{"x", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"x", "[", "2", "]"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"x", "[", "4", "]"}]}], "+", 
     RowBox[{"x", "[", "5", "]"}], "-", 
     RowBox[{"d", " ", 
      RowBox[{"x", "[", "5", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.7659179440176353`*^9, 3.765918029107206*^9, 
  3.7659181545876446`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", "F", "]"}]], "Input",
 CellChangeTimes->{{3.7659181057293186`*^9, 3.765918107950404*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"hello", "=", 
   RowBox[{
    RowBox[{"Drive", "[", 
     RowBox[{
      RowBox[{"Recombination", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"F", "[", "i", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "Gametes", "]"}]}], "}"}]}], "]"}], ",", 
        "pars"}], "]"}], ",", "pars"}], "]"}], "//", "FullSimplify"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.76591792974866*^9, 3.7659180739752665`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"hello", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.765918016491941*^9, 3.765918017277869*^9}, {
  3.76591807661417*^9, 3.7659180774918537`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"F", "[", "1", "]"}], "2"]}], "+", 
    RowBox[{
     RowBox[{"F", "[", "2", "]"}], " ", 
     RowBox[{"F", "[", "3", "]"}]}], "+", 
    RowBox[{
     RowBox[{"F", "[", "1", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"F", "[", "2", "]"}], "+", 
          RowBox[{"F", "[", "3", "]"}]}], ")"}]}], "+", 
       RowBox[{"F", "[", "4", "]"}]}], ")"}]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"F", "[", "1", "]"}], "2"]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"F", "[", "2", "]"}], "2"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
     RowBox[{"F", "[", "1", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"F", "[", "2", "]"}], "+", 
          RowBox[{"F", "[", "3", "]"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
        RowBox[{"F", "[", "4", "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
     RowBox[{"F", "[", "2", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
        RowBox[{"F", "[", "3", "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
        RowBox[{"F", "[", "4", "]"}]}]}], ")"}]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"F", "[", "3", "]"}], "+", 
       RowBox[{"F", "[", "4", "]"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"F", "[", "3", "]"}], "+", 
       RowBox[{"F", "[", "4", "]"}], "-", 
       RowBox[{"d", " ", 
        RowBox[{"F", "[", "4", "]"}]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.7659180998041887`*^9, 3.7659181194137325`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"hello", "=", 
   RowBox[{
    RowBox[{"Recombination", "[", 
     RowBox[{
      RowBox[{"Drive", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"F", "[", "i", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "Gametes", "]"}]}], "}"}]}], "]"}], ",", 
        "pars"}], "]"}], ",", "pars"}], "]"}], "//", "FullSimplify"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7659181796277184`*^9, 3.765918188051194*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"hello", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"F", "[", "1", "]"}], "4"]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"F", "[", "1", "]"}], "3"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", "d"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"F", "[", "2", "]"}], "+", 
          RowBox[{"F", "[", "3", "]"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"5", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "4"}], "+", "d"}], ")"}], " ", "d"}]}], ")"}], " ", 
        RowBox[{"F", "[", "4", "]"}]}]}], ")"}]}], "-", 
    RowBox[{
     RowBox[{"F", "[", "2", "]"}], " ", 
     RowBox[{"F", "[", "3", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
        RowBox[{"F", "[", "2", "]"}]}], "-", 
       RowBox[{"F", "[", "3", "]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
        RowBox[{"F", "[", "4", "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"F", "[", "2", "]"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"F", "[", "3", "]"}], "+", 
          RowBox[{"F", "[", "4", "]"}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"F", "[", "1", "]"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"6", "-", 
          RowBox[{"4", " ", "d"}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"F", "[", "2", "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"6", "-", 
          RowBox[{"4", " ", "d"}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"F", "[", "3", "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "5"}], "+", 
          RowBox[{"3", " ", "d"}]}], ")"}], " ", 
        RowBox[{"F", "[", "3", "]"}], " ", 
        RowBox[{"F", "[", "4", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"4", "+", 
          RowBox[{"3", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", "d"}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"F", "[", "4", "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"F", "[", "2", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"13", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "8"}], "+", "d"}], ")"}], " ", "d"}]}], ")"}], 
           " ", 
           RowBox[{"F", "[", "3", "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "5"}], "+", 
             RowBox[{"3", " ", "d"}]}], ")"}], " ", 
           RowBox[{"F", "[", "4", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"F", "[", "1", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"F", "[", "2", "]"}], "3"]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"F", "[", "3", "]"}], "+", 
          RowBox[{"F", "[", "4", "]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"F", "[", "3", "]"}]}], "+", 
          RowBox[{"F", "[", "4", "]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"F", "[", "3", "]"}], "+", 
          RowBox[{"F", "[", "4", "]"}], "-", 
          RowBox[{"d", " ", 
           RowBox[{"F", "[", "4", "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"F", "[", "2", "]"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"8", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "7"}], "+", "d"}], ")"}], " ", "d"}]}], ")"}], 
           " ", 
           RowBox[{"F", "[", "3", "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "5"}], "+", 
             RowBox[{"2", " ", "d"}]}], ")"}], " ", 
           RowBox[{"F", "[", "4", "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"F", "[", "2", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"8", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "7"}], "+", "d"}], ")"}], " ", "d"}]}], ")"}], 
           " ", 
           SuperscriptBox[
            RowBox[{"F", "[", "3", "]"}], "2"]}], "+", 
          RowBox[{"4", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", "d"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
           RowBox[{"F", "[", "3", "]"}], " ", 
           RowBox[{"F", "[", "4", "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "4"}], "+", 
             RowBox[{"3", " ", "d"}]}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"F", "[", "4", "]"}], "2"]}]}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.7659182012559047`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1520, 772},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 160, 2, 64, "Chapter"],
Cell[CellGroupData[{
Cell[765, 28, 3541, 95, 202, "Input"],
Cell[4309, 125, 9735, 200, 72, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14081, 330, 95, 1, 43, "Subsection"],
Cell[CellGroupData[{
Cell[14201, 335, 592, 14, 30, "Input"],
Cell[14796, 351, 3174, 100, 57, "Output"]
}, Open  ]],
Cell[17985, 454, 329, 9, 30, "Input"],
Cell[CellGroupData[{
Cell[18339, 467, 452, 12, 30, "Input"],
Cell[18794, 481, 2305, 76, 84, "Output"]
}, Open  ]],
Cell[21114, 560, 287, 7, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21438, 572, 94, 1, 43, "Subsection"],
Cell[21535, 575, 599, 18, 30, "Input"],
Cell[22137, 595, 1530, 52, 50, "Input"],
Cell[23670, 649, 1530, 52, 50, "Input"],
Cell[25203, 703, 3000, 93, 170, "Input"],
Cell[CellGroupData[{
Cell[28228, 800, 999, 31, 87, "Input"],
Cell[29230, 833, 551, 17, 47, "Output"]
}, Open  ]],
Cell[29796, 853, 96, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[29917, 858, 318, 7, 30, "Input"],
Cell[30238, 867, 632, 18, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30907, 890, 371, 9, 49, "Input"],
Cell[31281, 901, 865, 28, 45, "Output"]
}, Open  ]],
Cell[32161, 932, 126, 2, 30, "Input"],
Cell[32290, 936, 550, 16, 30, "Input"],
Cell[CellGroupData[{
Cell[32865, 956, 197, 4, 30, "Input"],
Cell[33065, 962, 2466, 81, 69, "Output"]
}, Open  ]],
Cell[35546, 1046, 551, 16, 30, "Input"],
Cell[CellGroupData[{
Cell[36122, 1066, 81, 2, 30, "Input"],
Cell[36206, 1070, 6424, 202, 115, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

